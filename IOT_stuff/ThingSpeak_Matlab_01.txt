% Read wind speed and direction from a ThingSpeak channel and visualize 
% wind velocity using the MATLAB COMPASS plot function. 
   
% Channel 12397 contains data from the MathWorks Weather Station, located 
% in Natick, Massachusetts. The data is collected once every minute. Field 
% 1 contains wind direction data and field 2 contains wind speed data. 
   
% Channel ID to read data from 
readChannelID = 991218; 
% Wind Direction Field ID 
SpeciesIDFieldID = 3; 
% Wind Speed Field ID 
AudioEventsFieldID = 4; 
   
% Channel Read API Key   
% If your channel is private, then enter the read API 
% Key between the '' below:   
readAPIKey = '482Q3KISO7KBSWBZ'; 
   
% Fetch wind direction for the last 60 points from the MathWorks weather 
% station. Learn more about the THINGSPEAKREAD function by going to 
% the Documentation tab on the right side pane of this page. 
speciesID= thingSpeakRead(readChannelID,'Fields',SpeciesIDFieldID,'NumPoints',10,...
'ReadKey',readAPIKey); 
   
% Fetch wind speed for the last 60 points from the MathWorks weather station 
numAudioEvents = thingSpeakRead(readChannelID,'Fields',AudioEventsFieldID,...
'NumPoints',10,'ReadKey',readAPIKey); 

numAudioEvents

% Transpose is firstly required, to use 'unique' properly:
w = unique(transpose(speciesID),'stable');
w
labels = string(transpose(w));

% Transpose is firstly required, to use 'unique' properly:
y = unique(transpose(numAudioEvents),'stable');
x = transpose(y)


% This is where the mapping occurs:
numbers_to_decode = {'17','26','35','71','92'};
names = {'C.PIP','HOUSE.KEYS','PLECOTUS','RHINO.HIPPO','S.PIP'};
M = containers.Map(numbers_to_decode,names)

k = keys(M) ;
val = values(M) ;

for i = 1:length(labels)
     % [k{i} val{i}]
     z{i}=M(labels{i})
end


pie(x,z)

% legend(z)
% title('Bat Species Audio Events')

